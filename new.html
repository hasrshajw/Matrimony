<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrimony Portal - Admin Dashboard</title>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    <style>
        :root {
            --font-main: 'Inter', sans-serif;
            --ease-cubic: cubic-bezier(0.4, 0, 0.2, 1);
            --radius-md: 8px;
            --radius-lg: 16px;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        [data-theme="light"] {
            --color-primary: #4f46e5;
            --color-primary-light: #e0e7ff;
            --color-background: #f8fafc;
            --color-surface: #ffffff;
            --color-text-primary: #1f2937;
            --color-text-secondary: #64748b;
            --color-border: #e5e7eb;
            --color-danger: #dc2626;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; }
        body { font-family: var(--font-main); background-color: var(--color-background); color: var(--color-text-primary); font-size: 14px; overflow: hidden; }
        
        /* --- LAYOUT & SHELL --- */
        .dashboard-container { display: grid; grid-template-columns: 260px 1fr; height: 100vh; position: relative; }
        .sidebar { background-color: var(--color-surface); border-right: 1px solid var(--color-border); padding: 2rem 1.5rem; display: flex; flex-direction: column; }
        .main-area { display: flex; flex-direction: column; overflow-y: auto; }
        .main-header { padding: 0.75rem 1.5rem; border-bottom: 1px solid var(--color-border); display: flex; justify-content: space-between; align-items: center; background-color: var(--color-surface); position: sticky; top: 0; z-index: 10; }
        .content-body { padding: 2rem 2.5rem; display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; align-items: flex-start; }
        .column { display: flex; flex-direction: column; gap: 2rem; }

        /* --- HEADER & NAVIGATION --- */
        .sidebar-header { margin-bottom: 3rem; font-size: 1.5rem; font-weight: 600; }
        .main-nav { flex-grow: 1; }
        .main-nav ul { list-style: none; display: flex; flex-direction: column; gap: 0.5rem; }
        .main-nav a { display: flex; align-items: center; gap: 1rem; text-decoration: none; color: var(--color-text-primary); font-weight: 500; padding: 0.75rem 1rem; border-radius: var(--radius-md); transition: all 0.2s ease; }
        .main-nav a i { font-size: 1.5rem; color: var(--color-text-secondary); }
        .main-nav a:hover { background-color: var(--color-primary-light); color: var(--color-primary); }
        .main-nav a.active { background-color: var(--color-primary-light); color: var(--color-primary); font-weight: 600; }
        .main-nav a.active i { color: var(--color-primary); }
        
        /* --- PROFILE SECTION (SIDEBAR) --- */
        .profile-section { margin-top: auto; padding-top: 1.5rem; border-top: 1px solid var(--color-border); cursor: pointer; }
        .profile-content-wrapper { display: flex; align-items: center; gap: 0.75rem; width: 100%; }
        .profile-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
        .profile-details { flex-grow: 1; min-width: 0; }
        .profile-name { font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .profile-email { font-size: 0.8rem; color: var(--color-text-secondary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* --- COMPONENTS --- */
        .widget { background-color: var(--color-surface); border-radius: var(--radius-lg); border: 1px solid var(--color-border); padding: 1.75rem; box-shadow: var(--shadow-sm); }
        .widget-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .widget-header h2 { font-size: 1.2rem; font-weight: 600; margin: 0; }
        .widget-header a { font-size: 0.9rem; color: var(--color-primary); text-decoration: none; font-weight: 500; }
        .metric-card { text-align: left; background: none; padding: 0; box-shadow: none; display: flex; align-items: center; gap: 1rem; }
        .metric-card .icon-wrapper { width: 48px; height: 48px; border-radius: 50%; display: grid; place-items: center; background-color: var(--color-primary-light); color: var(--color-primary); flex-shrink: 0; }
        .metric-card .icon-wrapper i { font-size: 1.5rem; }
        .metric-card .value { font-size: 1.75rem; font-weight: 700; color: var(--color-text-primary); line-height: 1.2; }
        .metric-card .label { font-size: 0.85rem; color: var(--color-text-secondary); }
        .quick-action-card { text-align: center; background-color: var(--color-surface); padding: 1rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .quick-action-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-md); }
        .quick-action-card a { text-decoration: none; color: inherit; display: flex; flex-direction: column; align-items: center; gap: 0.75rem; }
        .quick-action-card .icon { font-size: 1.75rem; color: var(--color-primary); width: 48px; height: 48px; display: grid; place-items: center; background-color: var(--color-primary-light); border-radius: 50%; }
        .quick-action-card span { font-weight: 500; }
        .btn { padding: 10px 15px; border: none; border-radius: var(--radius-md); cursor: pointer; font-size: 0.9rem; font-weight: 600; }
        .btn-logout { background-color: var(--color-danger); color: white; }
        .btn-view-profile { background-color: var(--color-primary); color: white; text-decoration: none; padding: 6px 12px; font-size: 0.85rem; }
        .profile-list li { display: flex; align-items: center; gap: 1rem; padding: 0.75rem 0; border-bottom: 1px solid var(--color-border); }
        .profile-list li:last-child { border-bottom: none; }
        .profile-avatar-sm { width: 36px; height: 36px; border-radius: 50%; object-fit: cover; }
        .profile-info { flex-grow: 1; }
        
        /* --- UTILITIES & SKELETON --- */
        .hidden { display: none !important; }
        .skeleton { background-color: #e2e8f0; position: relative; overflow: hidden; border-radius: var(--radius-md); }
        .skeleton::after { content: ''; position: absolute; top: 0; right: 0; bottom: 0; left: 0; transform: translateX(-100%); background-image: linear-gradient(90deg, rgba(255, 255, 255, 0) 0, rgba(255, 255, 255, 0.2) 20%, rgba(255, 255, 255, 0.5) 60%, rgba(255, 255, 255, 0)); animation: shimmer 1.5s infinite; }
        @keyframes shimmer { 100% { transform: translateX(100%); } }
        
        /* --- RESPONSIVE & MOBILE --- */
        .menu-toggle, .mobile-profile-popup, .header-title-container { display: none; }
        @media (max-width: 1024px) {
            .dashboard-container { grid-template-columns: 1fr; }
            .sidebar { display: none; }
            body { overflow-y: auto; }
            .main-area { overflow: visible; }
            .content-body { grid-template-columns: 1fr; padding: 1.5rem; }
            .main-header { justify-content: space-between; padding: 0.75rem 1.5rem; background-color: var(--color-primary); color: white; }
            .main-header.scrolled { background-color: var(--color-surface); color: var(--color-text-primary); box-shadow: var(--shadow-sm); }
            .main-header.scrolled .header-avatar { border-color: var(--color-border); }
            .main-header.scrolled .header-welcome-text { display: none; }
            .main-header.scrolled h1 { display: block; font-size: 1.25rem; }
            .header-profile-toggle { display: flex; align-items: center; gap: 0.75rem; cursor: pointer; }
            .header-avatar { width: 40px; height: 40px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.3); }
            .header-title-container { text-align: right; }
            .header-welcome-text { display: flex; flex-direction: column; align-items: flex-end; }
            .header-welcome-text small { font-size: 0.75rem; color: rgba(255,255,255,0.7); }
            #header-user-name { font-size: 1rem; font-weight: 600; }
            .main-header h1 { display: none; }
            .mobile-profile-popup { display: block; position: fixed; top: 68px; right: 1.5rem; width: 280px; background-color: var(--color-surface); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); border: 1px solid var(--color-border); padding: 0.75rem; z-index: 1000; opacity: 0; pointer-events: none; transform: scale(0.95); transform-origin: top right; transition: all 0.2s var(--ease-cubic); }
            .mobile-profile-popup.active { opacity: 1; pointer-events: all; transform: scale(1); }
            .popup-header { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 0.5rem 1rem; border-bottom: 1px solid var(--color-border); }
            .popup-list { list-style: none; padding-top: 0.5rem; }
            .popup-list a { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-radius: var(--radius-md); text-decoration: none; color: var(--color-text-primary); font-weight: 500; }
            .popup-list a:hover { background-color: var(--color-primary-light); }
            .popup-list a i { font-size: 1.25rem; color: var(--color-text-secondary); }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- DESKTOP SIDEBAR -->
        <aside class="sidebar">
            <div class="sidebar-header">Matrimony Admin</div>
            <nav class="main-nav">
                <ul>
                    <li><a href="admin-dashboard.html" class="active"><i class='bx bxs-dashboard'></i> Dashboard</a></li>
                    <li><a href="admin-users.html"><i class='bx bxs-user-account'></i> Manage Users</a></li>
                    <li><a href="admin-profiles.html"><i class='bx bxs-contact'></i> Manage Profiles</a></li>
                    <li><a href="create-profile.html"><i class='bx bxs-user-plus'></i> Add Profile</a></li>
                    <li><a href="admin-history.html"><i class='bx bxs-time-five'></i> Global History</a></li>
                </ul>
            </nav>
            <div class="profile-section" id="profile-section">
                <div class="profile-content-wrapper">
                    <img src="" alt="Admin" class="profile-avatar" id="sidebar-avatar">
                    <div class="profile-details">
                        <span class="profile-name" id="sidebar-user-email"></span>
                        <span class="profile-email" id="sidebar-user-role"></span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT AREA -->
        <main class="main-area" id="main-area">
            <header class="main-header" id="main-header">
                <div class="header-profile-toggle" id="header-profile-toggle">
                    <img src="" alt="Admin" class="profile-avatar header-avatar" id="header-avatar">
                </div>
                <div class="header-title-container">
                    <div class="header-welcome-text">
                        <small>Welcome</small>
                        <span id="header-user-name"></span>
                    </div>
                    <h1>Admin Dashboard</h1>
                </div>
                <button id="logout-btn-desktop" class="btn btn-logout">Logout</button>
            </header>

            <!-- SKELETON LOADER -->
            <section class="content-body" id="skeleton-loader">
                <div class="column">
                    <div class="widget">
                        <div class="widget-header"><div class="skeleton" style="width: 150px; height: 24px;"></div></div>
                        <div class="skeleton" style="width: 100%; height: 150px;"></div>
                    </div>
                    <div class="widget">
                        <div class="widget-header"><div class="skeleton" style="width: 200px; height: 24px;"></div></div>
                        <div class="skeleton" style="width: 100%; height: 200px;"></div>
                    </div>
                </div>
                <div class="column">
                    <div class="widget">
                        <div class="widget-header"><div class="skeleton" style="width: 120px; height: 24px;"></div></div>
                        <div class="skeleton" style="width: 100%; height: 250px;"></div>
                    </div>
                    <div class="widget">
                         <div class="widget-header"><div class="skeleton" style="width: 180px; height: 24px;"></div></div>
                        <div class="skeleton" style="width: 100%; height: 100px;"></div>
                    </div>
                </div>
            </section>
            
            <!-- REAL CONTENT -->
            <section class="content-body hidden" id="real-content">
                <div class="column">
                    <div class="widget">
                        <div class="widget-header"><h2>Key Metrics</h2></div>
                        <div class="metrics-grid" style="grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <div class="metric-card"><div class="icon-wrapper"><i class='bx bxs-group'></i></div><div><div class="value" id="total-users-metric">0</div><div class="label">Total Users</div></div></div>
                            <div class="metric-card"><div class="icon-wrapper"><i class='bx bxs-user-check'></i></div><div><div class="value" id="active-profiles-metric">0</div><div class="label">Active Profiles</div></div></div>
                            <div class="metric-card"><div class="icon-wrapper"><i class='bx bxs-user-x'></i></div><div><div class="value" id="pending-users-metric">0</div><div class="label">Pending Users</div></div></div>
                            <div class="metric-card"><div class="icon-wrapper"><i class='bx bxs-heart-circle'></i></div><div><div class="value" id="married-profiles-metric">0</div><div class="label">Married Profiles</div></div></div>
                        </div>
                    </div>
                    <div class="widget">
                        <div class="widget-header"><h2>Profiles Added Per Month</h2></div>
                        <canvas id="profilesByMonthChart"></canvas>
                    </div>
                </div>
                <div class="column">
                    <div class="widget">
                        <div class="widget-header"><h2>Quick Actions</h2></div>
                        <div class="quick-actions-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <a href="admin-users.html" class="quick-action-card"><div class="icon"><i class='bx bxs-user-account'></i></div><span>Manage Users</span></a>
                            <a href="admin-profiles.html" class="quick-action-card"><div class="icon"><i class='bx bxs-contact'></i></div><span>All Profiles</span></a>
                            <a href="create-profile.html" class="quick-action-card"><div class="icon"><i class='bx bxs-user-plus'></i></div><span>Add Profile</span></a>
                            <a href="admin-history.html" class="quick-action-card"><div class="icon"><i class='bx bxs-time-five'></i></div><span>History</span></a>
                        </div>
                    </div>
                    <div class="widget">
                        <div class="widget-header"><h2>Recently Added</h2><a href="admin-profiles.html">View All</a></div>
                        <ul class="profile-list" id="recently-added-profiles-list"></ul>
                    </div>
                </div>
            </section>
        </div>
    </main>
    
    <!-- MOBILE PROFILE POPUP -->
    <div class="mobile-profile-popup" id="mobile-profile-popup">
        <div class="popup-header">
            <img src="" alt="Admin" class="profile-avatar" id="popup-avatar">
            <div class="profile-details">
                <span class="profile-name" id="popup-user-email"></span>
                <span class="profile-email" id="popup-user-role"></span>
            </div>
        </div>
        <ul class="popup-list">
            <li><a href="admin-dashboard.html"><i class='bx bxs-dashboard'></i> Dashboard</a></li>
            <li><a href="admin-users.html"><i class='bx bxs-user-account'></i> Manage Users</a></li>
            <li><a href="admin-profiles.html"><i class='bx bxs-contact'></i> Manage Profiles</a></li>
            <li><a href="#" id="logout-btn-mobile"><i class='bx bx-log-out' style="color: var(--color-danger);"></i> Logout</a></li>
        </ul>
    </div>
</body>
</html>
