<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best Match - Advanced UI/UX</title>
    <style>
        /* --- GOOGLE FONTS IMPORT --- */
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;500;600&display=swap');

        /* --- CSS VARIABLES FOR THEME --- */
        :root {
            --bg-color: #eaecf9;
            --highlight-color: #cd2e44;
            --dark-color: #34103c;
            --white-color: #ffffff;
            --text-light: #6a5f7b;
        }

        /* --- GENERAL STYLES --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            background-color: var(--bg-color);
            color: var(--dark-color);
            overflow-x: hidden; /* Prevent accidental horizontal scroll during transitions */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }


        /* --- NAVBAR STYLES --- */
        header {
            background-color: var(--white-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.04);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 75px;
        }

        .navbar .logo a {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--dark-color);
            text-decoration: none;
        }

        .navbar .nav-buttons {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .navbar .nav-buttons a {
            text-decoration: none;
            color: var(--dark-color);
            font-weight: 600;
            font-size: 1rem;
            transition: color 0.3s ease;
        }
        .navbar .nav-buttons a:hover {
            color: var(--highlight-color);
        }

        .navbar .nav-buttons .login-btn {
            background-color: var(--highlight-color);
            color: var(--white-color);
            padding: 0.7rem 1.9rem;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .navbar .nav-buttons .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(205, 46, 68, 0.3);
        }


        /* --- HERO SECTION STYLES --- */
        .hero-section-wrapper {
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 75px);
        }

        .hero {
            flex-grow: 1;
            display: flex;
            width: 100%;
            background-color: var(--white-color);
        }

        .hero-image-container {
            flex: 0 0 60%;
            position: relative;
        }

        .hero-image-container picture,
        .hero-image-container picture img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .hero-text {
            flex: 0 0 40%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 2rem 4rem;
            box-sizing: border-box;
        }

        .hero-text .subheading {
            color: var(--highlight-color);
            font-weight: 700;
            font-size: 1rem;
            letter-spacing: 1px;
            margin-bottom: 0.75rem;
        }

        .hero-text h1 {
            font-size: 4rem;
            font-weight: 900;
            color: var(--dark-color);
            margin: 0;
            line-height: 1.1;
        }

        .hero-text p {
            font-size: 1rem;
            color: var(--text-light);
            max-width: 450px;
            margin: 1.5rem 0;
            line-height: 1.6;
        }

        .cta-buttons {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        .read-more-btn {
            background-color: var(--highlight-color);
            color: var(--white-color);
            padding: 0.9rem 2.2rem;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            text-decoration: none;
            font-weight: bold;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .read-more-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(205, 46, 68, 0.3);
        }

        .scroll-down-btn {
            background-color: transparent;
            color: var(--dark-color);
            border: 2px solid #e0dbe8;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: border-color 0.3s ease, color 0.3s ease;
        }
        .scroll-down-btn:hover {
            border-color: var(--dark-color);
        }


        /* --- FEATURES SECTION STYLES --- */
        .features-section {
            padding: 6rem 0;
        }

        .features-section .intro-text {
            text-align: center;
            margin-bottom: 4.5rem;
        }

        .tagline {
            color: var(--highlight-color);
            font-weight: 700;
            font-size: 1rem;
            letter-spacing: 1px;
            margin-bottom: 1rem;
        }

        .features-section h2 {
            font-size: 2.8rem;
            font-weight: 800;
            color: var(--dark-color);
            margin: 0 0 1rem 0;
        }

        .features-section .main-headline {
            font-size: 1.5rem;
            color: var(--text-light);
            font-weight: 500;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2.5rem;
        }

        .feature-card {
            background-color: var(--white-color);
            border-radius: 16px;
            padding: 2.5rem;
            text-align: center;
            box-shadow: 0 10px 25px rgba(52, 16, 60, 0.05);
            border: 2px solid transparent;
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(52, 16, 60, 0.1);
            border-color: var(--highlight-color);
        }

        .feature-card .icon-wrapper {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background-color: var(--highlight-color);
            color: var(--white-color);
        }

        .feature-card h3 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--dark-color);
            margin: 0 0 0.75rem 0;
        }

        .feature-card p {
            font-size: 1rem;
            color: var(--text-light);
            line-height: 1.6;
            margin: 0;
        }


        /* --- TRUSTED SECTION STYLES --- */
        .trusted-section {
            padding: 6rem 0;
            background-color: var(--white-color);
        }

        .trusted-content {
            display: flex;
            align-items: center;
            gap: 4rem;
        }

        .trusted-text {
            flex: 1 1 50%;
        }

        .trusted-text h2 {
            font-size: 2.8rem;
            font-weight: 800;
            color: var(--dark-color);
            margin: 0 0 1rem 0;
        }

        .trusted-text p.description {
            font-size: 1.1rem;
            color: var(--text-light);
            line-height: 1.7;
            margin-bottom: 2rem;
        }

        .trusted-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .trusted-list li {
            display: flex;
            align-items: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 1rem;
        }

        .trusted-list .checkmark {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--highlight-color);
            color: var(--white-color);
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .trusted-image {
            flex: 1 1 50%;
            text-align: center;
        }

        .trusted-image img {
            max-width: 100%;
            border-radius: 16px;
            box-shadow: 0 15px 40px rgba(52, 16, 60, 0.15);
        }


        /* --- STICKY METHOD SECTION STYLES --- */
        .sticky-wrapper {
            position: relative;
            height: 300vh;
        }
        
        .method-section {
            position: sticky;
            top: 0;
            height: 100vh;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .method-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        .method-section-header {
            text-align: center;
            margin-bottom: 5rem;
        }
        .method-section-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            color: var(--dark-color);
            margin: 0;
            line-height: 1.1;
        }
        .method-section-header p {
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            color: var(--highlight-color);
            margin-top: 0.75rem;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .stepper-wrapper {
            max-width: 1000px;
            margin: 0 auto;
        }

        .stepper-container {
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            z-index: 2;
        }

        .stepper-track {
            position: absolute;
            top: 50px;
            left: 5%;
            right: 5%;
            height: 4px;
            background-color: #e0dbe8;
            z-index: 1;
            border-radius: 4px;
        }

        .stepper-progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(90deg, var(--dark-color), var(--highlight-color));
            width: 0%;
            border-radius: 4px;
            transition: width 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }

        .step {
            flex: 1;
            text-align: center;
            position: relative;
            z-index: 2;
            padding: 2rem;
            margin: 0 1rem;
            border-radius: 24px;
            background-color: var(--white-color);
            border: 2px solid #f0f2f5;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            cursor: pointer;
        }

        .step:not(.active):hover {
            border-color: #d1cddb;
            transform: translateY(-5px);
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: var(--white-color);
            border: 4px solid #e0dbe8;
            color: #d1cddb;
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
            margin-bottom: 2rem;
            transition: all 0.4s ease;
            position: relative;
        }

        .step-content {
            opacity: 0.7;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .step-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 1rem;
        }

        .step-description {
            font-family: 'Poppins', sans-serif;
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-light);
        }

        .step.active {
            background: linear-gradient(145deg, var(--dark-color), #2a0d31);
            border-color: transparent;
            transform: scale(1.05) translateY(-10px);
            box-shadow: 0 30px 60px -12px rgba(52, 16, 60, 0.35);
            cursor: default;
        }

        .step.active .step-number {
            background-color: var(--highlight-color);
            color: var(--white-color);
            border-color: var(--highlight-color);
            box-shadow: 0 0 0 8px rgba(205, 46, 68, 0.2);
            animation: pulse-glow 2s infinite;
        }

        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 0 rgba(205, 46, 68, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(205, 46, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(205, 46, 68, 0); }
        }

        .step.active .step-content {
            opacity: 1;
            transform: translateY(0);
        }

        .step.active .step-title {
            color: var(--white-color);
        }

        .step.active .step-description {
            color: rgba(255, 255, 255, 0.8);
        }

        .stepper-pagination {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 4rem;
        }

        .stepper-pagination .pagination-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--white-color);
            border: 2px solid #d1cddb;
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stepper-pagination .pagination-dot:hover {
            border-color: var(--dark-color);
            color: var(--dark-color);
        }

        .stepper-pagination .pagination-dot.active {
            background-color: var(--highlight-color);
            border-color: var(--highlight-color);
            color: var(--white-color);
            transform: scale(1.1);
        }
        
        /* --- FINAL SECTION STYLES --- */
        .final-section {
            padding: 6rem 2rem;
            text-align: center;
            background-color: var(--white-color);
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
            visibility: hidden;
        }
        .final-section.is-visible {
            opacity: 1;
            transform: translateY(0);
            visibility: visible;
        }
        .final-section h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem;
            color: var(--dark-color);
        }
        .final-section p {
            font-family: 'Poppins', sans-serif;
            font-size: 1.2rem;
            color: var(--text-light);
            max-width: 600px;
            margin: 1rem auto 2rem;
        }


        /* --- RESPONSIVE STYLES --- */
        @media (max-width: 1024px) {
            .hero, .trusted-content { flex-direction: column; }
            .hero-image-container { flex-basis: auto; width: 100%; }
            .hero-image-container picture img { height: auto; }
            .hero-text { flex-basis: auto; width: 100%; padding: 3rem 2rem; text-align: center; align-items: center; }
            .hero-section-wrapper { min-height: auto; }
            .features-grid { grid-template-columns: 1fr; gap: 2rem; }
            .features-section, .trusted-section, .final-section { padding: 4rem 1.5rem; }
            .trusted-content { text-align: center; }
            .trusted-list li { justify-content: center; }
            .trusted-image { margin-bottom: 2rem; order: -1; }

            .sticky-wrapper { height: 250vh; }
            .step { margin: 0 0.5rem; padding: 1.5rem 1rem; }
            .step-number { width: 80px; height: 80px; font-size: 2rem; margin-bottom: 1.5rem; }
            .stepper-track { top: 40px; }
        }
        
        @media (max-width: 768px) {
            .container, .navbar { padding: 0 1.5rem; }
            .hero-text h1, .features-section h2, .trusted-text h2, .method-section-header h2, .final-section h2 { font-size: 2.5rem; }
            .features-section .main-headline { font-size: 1.2rem; }
            
            .sticky-wrapper { height: auto; }
            .method-section { position: relative; height: auto; padding: 4rem 1.5rem; }
            .stepper-container { flex-direction: column; gap: 1.5rem; }
            .stepper-track, .stepper-progress-bar { display: none; }
            .step { display: flex; align-items: center; text-align: left; padding: 1.5rem; margin: 0; width: 100%; box-sizing: border-box; }
            .step-number { margin-bottom: 0; margin-right: 1.5rem; flex-shrink: 0; }
            .step.active { transform: scale(1.02) translateX(5px); }
        }

        @media (max-width: 480px) {
            .navbar .nav-buttons a { display: none; }
            .hero-text h1 { font-size: 2.2rem; }
            .cta-buttons { flex-direction: column; }
            
            .method-section-header h2 { font-size: 2.2rem; }
            .step { padding: 1.2rem; flex-direction: column; text-align: center; }
            .step-number { margin-right: 0; margin-bottom: 1rem; }
            .step.active { transform: scale(1.02) translateY(-5px); }
        }
    </style>
</head>
<body>

    <header>
        <nav class="navbar container">
            <div class="logo"><a href="#">LOGO</a></div>
            <div class="nav-buttons">
                <a href="#">About us</a>
                <a href="#">Help</a>
                <button class="login-btn">Login</button>
            </div>
        </nav>
    </header>

    <main>
        <div class="hero-section-wrapper">
             <section class="hero">
                <div class="hero-image-container">
                    <picture>
                        <source media="(max-width: 1024px)" srcset="https://img2.shaadi.com/assests/2025/images/homepage/marathi_mobile_bg.jpeg">
                        <img src="https://img2.shaadi.com/assests/2025/images/homepage/marathi_mobile_bg.jpeg" alt="Couple in traditional wedding attire">
                    </picture>
                </div>
                <div class="hero-text">
                    <span class="subheading">FIND YOUR</span>
                    <h1>Best Match</h1>
                    <p>Wine and cheese. Song and Dance. Spring and Summer. Hugs and Kisses. Some duos bring out the best in each other. It's time to find the one for you.</p>
                    <div class="cta-buttons">
                        <a href="#" class="read-more-btn">READ MORE</a>
                        <button class="scroll-down-btn">&darr;</button>
                    </div>
                </div>
            </section>
        </div>

        <section class="features-section">
            <div class="container">
                <div class="intro-text">
                    <p class="tagline">Verified & Family-Approved Profiles — Every profile is checked for authenticity.</p>
                    <h2>Why Choose Us — Trust Meets Technology</h2>
                    <p class="main-headline">“Made for Parents. Loved by Individuals.”</p>
                </div>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="icon-wrapper">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                        </div>
                        <h3>Personalized Matches on WhatsApp</h3>
                        <p>Receive hand-picked profiles directly to your WhatsApp.</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon-wrapper">
                             <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 18a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2"></path><rect x="3" y="4" width="18" height="18" rx="2"></rect><circle cx="12" cy="10" r="2"></circle><line x1="8" y1="2" x2="8" y2="4"></line><line x1="16" y1="2" x2="16" y2="4"></line></svg>
                        </div>
                        <h3>Quick & Friendly Support</h3>
                        <p>Talk to real people, not bots.</p>
                    </div>
                    <div class="feature-card">
                        <div class="icon-wrapper">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg>
                        </div>
                        <h3>For All Life Journeys</h3>
                        <p>Whether single, divorced, or widowed — everyone deserves a fresh start.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="trusted-section">
            <div class="container">
                <div class="trusted-content">
                    <div class="trusted-image">
                        <img src="https://img2.shaadi.com/assests/2023/images/home-page/mbs-2x.png" alt="Happy couple showing their phone.">
                    </div>
                    <div class="trusted-text">
                        <p class="tagline">Find your perfect match</p>
                        <h2>Trusted by Millions of Parents</h2>
                        <p class="description">We are a leading and trusted matrimonial service, committed to helping you find the perfect life partner for your loved ones.</p>
                        <ul class="trusted-list">
                            <li><span class="checkmark"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></span>100% Manually Screened Profiles</li>
                            <li><span class="checkmark"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></span>Control over privacy settings</li>
                            <li><span class="checkmark"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></span>Verification by visiting the place</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- WRAPPER FOR STICKY SCROLL EFFECT -->
        <div id="sticky-wrapper" class="sticky-wrapper">
            <section id="method-section" class="method-section">
                <div class="container stepper-wrapper">
                    <div class="method-section-header">
                        <h2>The BVowed Method</h2>
                        <p>As simple as 1-2-3!</p>
                    </div>

                    <div class="stepper-container">
                        <div class="stepper-track"><div id="progress-bar" class="stepper-progress-bar"></div></div>
                        <div class="step" data-step="0">
                            <div class="step-number">01</div>
                            <div class="step-content">
                                <h4 class="step-title">Tell us about you</h4>
                                <p class="step-description">Register on our exclusive platform and tell us about yourself to become part of our trusted community.</p>
                            </div>
                        </div>
                        <div class="step" data-step="1">
                            <div class="step-number">02</div>
                            <div class="step-content">
                                <h4 class="step-title">Verification Process</h4>
                                <p class="step-description">We conduct a stringent verification process to ensure every member is genuine, creating a safe environment.</p>
                            </div>
                        </div>
                        <div class="step" data-step="2">
                            <div class="step-number">03</div>
                            <div class="step-content">
                                <h4 class="step-title">Find Your Match</h4>
                                <p class="step-description">Explore verified profiles and connect with potential partners to begin your journey towards a life partner.</p>
                            </div>
                        </div>
                    </div>

                    <div class="stepper-pagination" id="stepper-pagination">
                        <div class="pagination-dot" data-step="0">1</div>
                        <div class="pagination-dot" data-step="1">2</div>
                        <div class="pagination-dot" data-step="2">3</div>
                    </div>
                </div>
            </section>
        </div>
        
        <!-- NEW FINAL SECTION -->
        <section id="final-section" class="final-section">
             <div class="container">
                <h2>Ready to Begin?</h2>
                <p>Your journey towards finding the perfect match starts with a single step. Join our community today and let us help you write your own beautiful story.</p>
                <a href="#" class="read-more-btn">REGISTER NOW</a>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const methodSection = document.getElementById('method-section');
            const stickyWrapper = document.getElementById('sticky-wrapper');
            const finalSection = document.getElementById('final-section');
            const steps = document.querySelectorAll('.step');
            const progressBar = document.getElementById('progress-bar');
            const paginationDots = document.querySelectorAll('.pagination-dot');

            let currentStep = 0;
            let isUserInteracting = false;
            let scrollTimeout;
            let mobileObserver;

            function updateStepperUI(newStepIndex) {
                if (newStepIndex === currentStep && newStepIndex !== 0) return;

                currentStep = newStepIndex;

                steps.forEach((step, index) => {
                    step.classList.toggle('active', index === currentStep);
                });
                
                paginationDots.forEach((dot, index) => {
                     dot.classList.toggle('active', index === currentStep);
                });

                const progressPercentage = (steps.length > 1) ? (currentStep / (steps.length - 1)) * 100 : 0;
                
                progressBar.style.width = `${progressPercentage}%`;
                
                if (currentStep === 2) {
                    finalSection.classList.add('is-visible');
                } else {
                    finalSection.classList.remove('is-visible');
                }
            }
            
            function handleDesktopScroll() {
                if (isUserInteracting) return;

                const rect = stickyWrapper.getBoundingClientRect();
                const wrapperTop = rect.top;
                const wrapperHeight = rect.height;

                if (wrapperTop <= 0 && wrapperTop > -wrapperHeight + window.innerHeight) {
                    const scrollableDistance = wrapperHeight - window.innerHeight;
                    const scrollProgress = Math.max(0, -wrapperTop / scrollableDistance);

                    let newStep = 0;
                    if (scrollProgress > 0.4) newStep = 1;
                    if (scrollProgress > 0.8) newStep = 2;

                    updateStepperUI(newStep);
                } else if (wrapperTop > 0 && currentStep !== 0) {
                     updateStepperUI(0);
                }
            }

            function handleManualUpdate(newStepIndex) {
                isUserInteracting = true;
                updateStepperUI(newStepIndex);
                
                if(window.innerWidth > 768) {
                    let scrollTarget;
                    const wrapperTop = stickyWrapper.offsetTop;
                    const scrollableDistance = stickyWrapper.offsetHeight - window.innerHeight;

                    if (newStepIndex === 0) scrollTarget = wrapperTop;
                    else if (newStepIndex === 1) scrollTarget = wrapperTop + scrollableDistance * 0.41;
                    else scrollTarget = wrapperTop + scrollableDistance * 0.81;
                    
                    window.scrollTo({
                        top: scrollTarget,
                        behavior: 'smooth'
                    });
                }
                
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    isUserInteracting = false;
                }, 1200);
            }

            function setupEventListeners() {
                window.removeEventListener('scroll', handleDesktopScroll);
                if (mobileObserver) mobileObserver.disconnect();

                if (window.innerWidth > 768) {
                    // --- DESKTOP LOGIC ---
                    window.addEventListener('scroll', handleDesktopScroll, { passive: true });
                } else {
                    // --- MOBILE LOGIC ---
                    mobileObserver = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                const newStepIndex = parseInt(entry.target.getAttribute('data-step'));
                                updateStepperUI(newStepIndex);
                            }
                        });
                    }, { threshold: 0.6 });

                    steps.forEach(step => mobileObserver.observe(step));
                }
            }
            
            paginationDots.forEach(dot => {
                dot.addEventListener('click', () => {
                    handleManualUpdate(parseInt(dot.getAttribute('data-step')));
                });
            });

            steps.forEach((step) => {
                step.addEventListener('click', function() {
                    handleManualUpdate(parseInt(this.getAttribute('data-step')));
                });
            });

            // Initial and resize setup
            setupEventListeners();
            window.addEventListener('resize', setupEventListeners);
            updateStepperUI(0); // Set initial state
        });
    </script>

</body>
</html>
